---
created: 2025-11-13 17:16
updated: 2025-11-13 17:16
tags:
description:
---
## 前提
* Google Drive APIはv3を使用してください。
## div
* 確認先毎にSpreadsheetが作成されていますが、確認先のユーザーを当該Spreadsheetに対して編集権限を付与してください。なお通知は不要です。
* また、「div回答シートURL一覧」というシートがスクリプトを実行されたSpreadsheet上に作成されていますが、回答シートを作成先にも同じ内容が記載されたSpreadsheetを作成してください。
	* 権限は社内のメンバーであれば、全員閲覧権限が付与されるようにしてください。アクセス権限を付与したという通知は不要です。
* アクセス権限の付与に必要なユーザーの情報は、後述の「ユーザーメールアドレスの取得」を参照してください。
## project
- 確認先毎にSpreadsheetが作成されていますが、確認先のユーザーを当該Spreadsheetに対して編集権限を付与してください。なお通知は不要です。
- projectの場合は、一覧毎に「他フォルダ管理者」という列でユーザーの氏名が記述されていますが、それらのユーザーに対しても編集権限を付与してください。
- また、「project回答シートURL一覧」というシートがスクリプトを実行されたSpreadsheet上に作成されていますが、回答シートを作成先のフォルダにも同じ内容が記載されたSpreadsheetを作成してください。
	* 権限は社内のメンバーであれば、全員閲覧権限が付与されるようにしてください。アクセス権限を付与したという通知は不要です。
* アクセス権限の付与に必要なユーザーの情報は、後述の「ユーザーメールアドレスの取得」を参照してください。

## ユーザーのメールアドレス取得
* 以下のSpreadsheetにユーザーの氏名とメールアドレスの一覧が存在します。
  https://docs.google.com/spreadsheets/d/1-5DVncFkrRIbQHrtB7pq2d7Mc5vc2GIdZX4w0wMfveQ
* A列に氏名が入力されていますが、「姓 名」（姓と名の間に半角スペース）のフォーマットで入力されています。
* H列にメールアドレスが入力されています。
* A列に一致する氏名であればH列のメールアドレスを取得するという処理で氏名からメールアドレスへ変換することができます。
	* なお、「（新）div」には「姓 名」（姓と名の間に半角スペース）のフォーマットですが、「（新）project-2」には「姓名」のフォーマットで入力されているため、一致する氏名を探す際にはフォーマットを揃えるように処理してください。


## 検証用
* 上述の機能を実装した上で、検証用としてどの確認先であっても、以下のユーザーに権限を付与する検証用のスクリプトも作成していただけませんか？編集権限で付与し、通知がされないように設定してください。
	* ryosuke.morita.ts@mixi.co.jp
	* yuta.toya.ts@mixi.co.jp
* 確認先のユーザーに権限を付与する前に、実際に別のユーザーに対して付与し、「権限が付与されたユーザーに通知がされないこと」を確認したいと考えています。
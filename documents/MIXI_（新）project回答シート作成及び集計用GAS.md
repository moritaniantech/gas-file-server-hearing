---
created: 2025-11-10 19:28
updated: 2025-11-10 19:28
tags:
  - mixi
  - google-apps-script
description:
---
## project
添付したファイルの「（新）project」シートについて以下の要件でGASを作成してください。
<前提>
* 添付した資料はファイルサーバーのデータ移行にあたり、各フォルダ毎にヒアリング先を確認したものです。
* 以下に記載した処理内容をもとにGoogle Apps Scriptを作成してください。
* 「（新）project-2」シートは4行目が列名、5行目からレコードが開始します。
* projectの回答シートはdivとフォーマットが異なり、「対象本部 ※推測込」「対象部室 ※ 推測込」の列は含めません。
<処理内容>
* まず大きく2つの処理が必要です。
	* 回答シート作成処理
		* 添付したファイルを確認先毎に分割する処理（ユーザーが回答を記入するためのシート）
		* 詳細については後述の通りです。
	* 回答シートマージ処理
		* 回答シート作成処理で作成されたシートのデータをすべてマージするための処理
		* 回答シート作成処理で作成されたシートをマージできるようにしてください。
* 回答シート作成処理
	* 最終的には、確認先の方々毎にSpreadsheetを作成し、確認対象となるリストを作成したいです。
	* それらの条件として以下のような形で実装してください。
		* G列「移行先」に「AWS S3」が入力されている場合は、確認不要として分類し、別のSpreadsheet（「project確認不要」）を作成してください。
		* I列の管理者に「×」が入力されている場合は、確認先を「確認先不明」として分類してください。
		* I列の管理者に「×」以外が入力されている場合は、確認先を「入力されている値」として分類してください。
			* ただし、以下の条件に基づいて確認先を1つ確定してください。
				* A列「projectフォルダ名」に同一の名称が複数行に記載されている場合、B列「ステータス」が「在職」と記入されている行から1件確認先を絞り出してください。A列が複数行に同じ値が記述されていることとB列が「在職」であることが満たされていれば、I列のどの値を確認先としても問題ありません。
					* つまり、1つのprojectフォルダに対して、確認先を1件に絞りたいです。
				* B列がすべて「在職」以外の場合、確認先不明として分類してください。
		* 上述で分類した確認先の値ごとにSpreadsheetを作成し、回答シートを作成してください。
	* 回答シートとして作成する際、以下のように作成してください。
		* 「（新）project−2」Spreadsheetのうち、必要なデータはA, C, D, E, F, G, H列です。
		* 回答シートではそれぞれ以下の列名としてください。
			* projectフォルダ（「（新）project−2」のA列から転記）
			* フォルダ数（「（新）project−2」のC列から転記、3桁区切り表示）
			* ファイル数（「（新）project−2」のD列から転記、3桁区切り表示）
			* データサイズ（「（新）project−2」のE列から転記）
			* 最終更新日（「（新）project−2」のF列から転記）
			* 他フォルダ管理者（「（新）project−2」のI列から転記だが後述の詳細をもとに転記してください）
				* 他フォルダ管理者については、以下のように処理して転記してください。
					* 「（新）project−2」のA列に同一のフォルダ名が記述されており、かつB列が「在職」のケースがあれば、I列の値をすべて「,」で繋げて転記してください。
					* ただし、確認先として抽出された方の氏名は「他フォルダ管理者」には記述しないでください。
		* ユーザーが回答を記入する欄として、以下の列を右側に追加してください。
			* 回答者メールアドレス
			* 移行先
				* 選択リストとして、Googleドライブ・Googleドライブ_別テナント・AWS S3・不要を選択できる状態にしてください。
				* 「（新）project−2」のシートにすでに記入されているはずなので、その値を新しく作成するシートにも記入してください。
			* 移行方法
				* 選択リストとして、自対応・hatakan依頼・不要を選択できる状態にしてください。
			* 共有ドライブ名
			* 個人情報有無
				* チェックボックスを設定
			* 自動化有無 ※スクリプトやRPAなど
				* チェックボックスを設定
			* その他
	* 回答シートの表については、ユーザーが見やすいように列の色、罫線の設定などフォーマットを整えてください。
		* ユーザーが回答を入力する列のタイトルは、他のタイトルと色を変えてください。
	* 確認先毎に、Spreadsheetファイルで分割するしてください。ただし、回答をマージする処理が必要になるため、その点に注意して実装してください。
	* Spreadsheetの作成先のGoogle DriveはフォルダIDで指定できるように構成してください。
	* 確認先毎に作成したSpreadsheetのURLをまとめて記載するシートをGASを実行しているSOURCEのSpreadsheetに作成してください。
		* 確認先の氏名、SpreadsheetのURL、件数を記述してください。
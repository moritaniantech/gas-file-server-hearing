---
created: 2025-11-10 19:28
updated: 2025-11-10 19:28
tags:
  - mixi
  - google-apps-script
description:
---
## div
添付したファイルの「（新）div」シートについて以下の要件でGASを作成してください。
<前提>
* 添付した資料はファイルサーバーのデータ移行にあたり、各フォルダ毎にヒアリング先を確認したものです。
* 以下に記載した処理内容をもとにGoogle Apps Scriptを作成してください。
<処理内容>
* まず大きく2つの処理が必要です。
	* 回答シート作成処理
		* 添付したファイルを確認先毎に分割する処理（ユーザーが回答を記入するためのシート）
		* 詳細については後述の通りです。
	* 回答シートマージ処理
		* 回答シート作成処理で作成されたシートのデータをすべてマージするための処理
		* 回答シート作成処理で作成されたシートをマージできるようにしてください。
* 回答シート作成処理
	* L列「確認先（本部長）」とM列「確認先（部室長）」に入力されている値をもとに以下の条件でシートを分割してください。
		* L列「確認先（本部長）」は氏名が入力されており、M列「確認先（部室長）」は「×」が入力されている場合は、L列を確認先とする。
		* L列「確認先（本部長）」は「×」が入力されており、M列「確認先（部室長）」はは氏名が入力されている場合は、M列を確認先とする。
		* L列とM列どちらも氏名が入力されている場合は、M列「確認先（部室長）」を確認先とする。
		* L, M列ともに「×」となっている場合は、確認先を不明とする。
		* ただし、E列「ファイル数」が0の場合は、上述の確認先から除外し、確認先を除外としてSpreadsheetにまとめてください。
		* 以上の確認先毎にSpreadsheetを特定の場所に作成してください。
	* 回答シートとして作成する際、以下のように作成してください。
		* 添付したSpreadsheetのうち、必要なデータはA, B, D, E, F, G, H, I, H, I, J, K列です。
		* 回答シートではそれぞれ以下の列名としてください。
			* divフォルダ_1階層目
			* divフォルダ_2階層目
			* フォルダ数（3桁区切り表示）
			* ファイル数（3桁区切り表示）
			* データサイズ
			* 最終更新日
			* 対象本部 ※ 推測込
			* 対象部室 ※ 推測込
		* ユーザーが回答を記入する欄として、以下の列を右側に追加してください。
			* 回答者メールアドレス
			* 移行先
				* 選択リストとして、Googleドライブ・Googleドライブ_別テナント・AWS S3・不要を選択できる状態にしてください。
				* 「（新）div」のシートにすでに記入されているはずなので、その値を新しく作成するシートにも記入してください。
			* 移行方法
				* 選択リストとして、自対応・hatakan依頼・不要を選択できる状態にしてください。
			* 共有ドライブ名
			* 個人情報有無
				* チェックボックスを設定
			* 自動化有無 ※スクリプトやRPAなど
				* チェックボックスを設定
			* その他
	* 回答シートの表については、ユーザーが見やすいように列の色、罫線の設定などフォーマットを整えてください。
		* ユーザーが回答を入力する列のタイトルは、他のタイトルと色を変えてください。
	* 確認先毎に、Spreadsheetファイルで分割するしてください。ただし、回答をマージする処理が必要になるため、その点に注意して実装してください。
	* Spreadsheetの作成先のGoogle DriveはフォルダIDで指定できるように構成してください。
	* 確認先毎に作成したSpreadsheetのURLをまとめて記載するシートをGASを実行しているSOURCEのSpreadsheetに作成してください。
		* 確認先の氏名、SpreadsheetのURL、件数を記述してください。